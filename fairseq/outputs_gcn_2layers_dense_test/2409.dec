haunted is a 2007 horror film written and directed by james wan and starring will smith . the film is based on the novel of the same name by james wan .