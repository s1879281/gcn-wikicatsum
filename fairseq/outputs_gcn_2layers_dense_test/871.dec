license to wed is a 2007 american romantic comedy film written and directed by john krasinski and starring mandy moore , mandy moore , mandy moore , john krasinski and robin williams .