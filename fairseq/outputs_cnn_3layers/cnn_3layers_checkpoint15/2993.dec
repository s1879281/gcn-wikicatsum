the tomb is a 2007 american horror film directed by alan taylor and written by john waters , based on the novel of the same name by edgar allan poe .