sweeney 2 is a 1978 british comedy film directed by john thaw and starring john thaw , dennis waterman and john thaw . it is based on the novel of the same name by troy kennedy .