great expectations is a 1946 british drama film directed by david lean . the screenplay by charles dickens is based on the charles dickens novel great expectations by charles dickens .