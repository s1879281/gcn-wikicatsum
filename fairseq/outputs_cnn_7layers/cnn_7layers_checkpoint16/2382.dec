anchorman : the legend of ron burgundy is a 2004 american comedy film written and directed by ferrell , and starring will ferrell and will ferrell in the lead roles . the film was released on august 31 , 2004 , by dreamworks pictures .