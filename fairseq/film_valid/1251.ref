the molly maguires is a 1970 american film based on a 1964 novel by arthur h. lewis that was directed by martin ritt .   it stars richard harris and sean connery .   set in late 19th century northeastern pennsylvania , this social drama tells the story of an undercover detective sent to a coal mining community to expose a secret society of irish-american miners battling exploitation at the hand of the owners .   partly inspired by a true story , the film portrays the rebellious leader of the molly maguires and his will to achieve social justice .